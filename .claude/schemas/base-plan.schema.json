{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://megacampus2.local/schemas/base-plan.schema.json",
  "title": "Base Plan Schema",
  "description": "Base schema for all orchestrator plan files",
  "type": "object",
  "required": ["workflow", "phase", "config", "validation"],
  "properties": {
    "workflow": {
      "type": "string",
      "description": "Name of the workflow (e.g., 'bug-management', 'security-audit')",
      "minLength": 1
    },
    "phase": {
      "type": "string",
      "description": "Current phase identifier",
      "minLength": 1
    },
    "phaseNumber": {
      "type": "integer",
      "description": "Numeric phase identifier for sequencing",
      "minimum": 1
    },
    "config": {
      "type": "object",
      "description": "Phase-specific configuration",
      "additionalProperties": true
    },
    "validation": {
      "type": "object",
      "description": "Validation criteria for this phase",
      "required": ["required"],
      "properties": {
        "required": {
          "type": "array",
          "description": "Blocking validation criteria that must pass",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "optional": {
          "type": "array",
          "description": "Non-blocking validation criteria (warnings only)",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "nextAgent": {
      "type": "string",
      "description": "Name of the next agent to invoke (worker name)",
      "minLength": 1
    },
    "timestamp": {
      "type": "string",
      "description": "ISO-8601 timestamp when plan was created",
      "format": "date-time"
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "properties": {
        "createdBy": {
          "type": "string",
          "description": "Agent that created this plan"
        },
        "iteration": {
          "type": "integer",
          "description": "Iteration number for iterative workflows",
          "minimum": 1
        },
        "maxIterations": {
          "type": "integer",
          "description": "Maximum iterations allowed",
          "minimum": 1
        }
      }
    }
  }
}
